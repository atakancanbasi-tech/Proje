{% extends "shop/base.html" %}
{% load l10n humanize %}
{% block title %}Sipariş Fişi — #{{ order.id }}{% endblock %}

{% block content %}
<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3 no-print">
    <h1 class="h4 m-0">Sipariş Fişi</h1>
    <button class="btn btn-outline-secondary" onclick="window.print()">Yazdır</button>
  </div>
  
  <div class="card shadow-sm">
    <div class="card-body">
      <div class="row">
        <div class="col-md-6">
          <h2 class="h6 text-muted">Sipariş</h2>
          <div><strong>No:</strong> #{{ order.id }}</div>
          <div><strong>Durum:</strong> {{ order.status|default:"-" }}</div>
          <div><strong>Tarih:</strong> {{ order.paid_at|default:order.created|default:order.created_at|date:"j F Y H:i" }}</div>
        </div>
        
        <div class="col-md-6">
          <h2 class="h6 text-muted">Müşteri</h2>
          <div><strong>Ad Soyad:</strong> {{ order.fullname|default:"-" }}</div>
          <div><strong>E-posta:</strong> {{ order.email|default:"-" }}</div>
          <div><strong>Adres:</strong> {{ order.address|default:"-" }}</div>
        </div>
      </div>
      
      <hr>
      
      <div class="table-responsive">
        <table class="table align-middle">
          <thead>
            <tr>
              <th>Ürün</th>
              <th class="text-center">Adet</th>
              <th class="text-end">Birim Fiyat</th>
              <th class="text-end">Tutar</th>
            </tr>
          </thead>
          <tbody>
            {% for it in items %}
            <tr>
              <td>{{ it.name }}</td>
              <td class="text-center">{{ it.qty }}</td>
              <td class="text-end">₺ {{ it.unit_price|floatformat:2|localize }}</td>
              <td class="text-end">₺ {{ it.line_total|floatformat:2|localize }}</td>
            </tr>
            {% empty %}
            <tr><td colspan="4" class="text-center text-muted">Kalem bulunamadı.</td></tr>
            {% endfor %}
          </tbody>
          <tfoot>
            <tr>
              <th colspan="3" class="text-end">Ara Toplam</th>
              <th class="text-end">₺ {{ subtotal|floatformat:2|localize }}</th>
            </tr>
            <tr>
              <th colspan="3" class="text-end">Kargo</th>
              <th class="text-end">₺ {{ shipping_fee|floatformat:2|localize }}</th>
            </tr>
            {% if discount %}
            <tr>
              <th colspan="3" class="text-end">İndirim</th>
              <th class="text-end text-success">-₺ {{ discount|floatformat:2|localize }}</th>
            </tr>
            {% endif %}
            <tr>
              <th colspan="3" class="text-end">Genel Toplam</th>
              <th class="text-end">₺ {{ grand_total|floatformat:2|localize }}</th>
            </tr>
          </tfoot>
        </table>
      </div>
      
      <div class="text-muted small">Bu belge bilgilendirme amaçlıdır.</div>
    </div>
  </div>
</div>
{% endblock %}